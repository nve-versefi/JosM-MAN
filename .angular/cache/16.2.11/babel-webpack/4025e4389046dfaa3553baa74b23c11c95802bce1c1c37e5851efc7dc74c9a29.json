{"ast":null,"code":"import _asyncToGenerator from \"D:/Local Repo/OrquestaJOSM/Orquesta-JOSM/JOsM/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { from, switchMap } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport * as Realm from \"realm-web\";\nimport * as i0 from \"@angular/core\";\nexport class IntegrantesService {\n  constructor() {\n    const APP_ID = 'data-jynqh'; // Replace with your actual App ID\n    this.app = new Realm.App({\n      id: APP_ID\n    });\n    // Immediately try to log in and store the resulting Observable\n    this.user$ = from(this.login());\n  }\n  login() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const credentials = Realm.Credentials.anonymous();\n      try {\n        // Authenticate the user\n        return yield _this.app.logIn(credentials);\n      } catch (error) {\n        console.error(\"Error logging into Realm:\", error);\n        throw error;\n      }\n    })();\n  }\n  // General method to call a Realm function, ensuring user is logged in first\n  callRealmFunction(functionName, args = []) {\n    return this.user$.pipe(switchMap(user => from(user.functions[functionName](...args))), catchError(error => {\n      console.error(`Error calling Realm function ${functionName}`, error);\n      throw error;\n    }));\n  }\n  // Define methods for each collection\n  obtenerDirectiva() {\n    return this.callRealmFunction('getDirectivas', []);\n  }\n  obtenerGaleria() {\n    return this.callRealmFunction('getGalerias', []);\n  }\n  obtenerMusicos() {\n    return this.callRealmFunction('getIntegrantes', []);\n  }\n  obtenerInfo() {\n    return this.callRealmFunction('getInfos', []);\n  }\n  obtenerEventos() {\n    return this.callRealmFunction('getEventos', []);\n  }\n  static #_ = this.ɵfac = function IntegrantesService_Factory(t) {\n    return new (t || IntegrantesService)();\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: IntegrantesService,\n    factory: IntegrantesService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"names":["from","switchMap","catchError","Realm","IntegrantesService","constructor","APP_ID","app","App","id","user$","login","_this","_asyncToGenerator","credentials","Credentials","anonymous","logIn","error","console","callRealmFunction","functionName","args","pipe","user","functions","obtenerDirectiva","obtenerGaleria","obtenerMusicos","obtenerInfo","obtenerEventos","_","_2","factory","ɵfac","providedIn"],"sources":["D:\\Local Repo\\OrquestaJOSM\\Orquesta-JOSM\\JOsM\\src\\app\\services\\data.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { Observable, from, switchMap } from 'rxjs';\r\nimport { catchError } from 'rxjs/operators';\r\nimport * as Realm from \"realm-web\";\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class IntegrantesService {\r\n  private app: Realm.App;\r\n  private user$: Observable<Realm.User>; // Use an Observable to track the login process\r\n\r\n  constructor() {\r\n    const APP_ID = 'data-jynqh'; // Replace with your actual App ID\r\n    this.app = new Realm.App({ id: APP_ID });\r\n\r\n    // Immediately try to log in and store the resulting Observable\r\n    this.user$ = from(this.login());\r\n  }\r\n\r\n  private async login(): Promise<Realm.User> {\r\n    const credentials = Realm.Credentials.anonymous();\r\n    try {\r\n      // Authenticate the user\r\n      return await this.app.logIn(credentials);\r\n    } catch (error) {\r\n      console.error(\"Error logging into Realm:\", error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  // General method to call a Realm function, ensuring user is logged in first\r\n  private callRealmFunction(functionName: string, args: any[] = []): Observable<any> {\r\n    return this.user$.pipe(\r\n      switchMap(user => \r\n        from(user.functions[functionName](...args))\r\n      ),\r\n      catchError(error => {\r\n        console.error(`Error calling Realm function ${functionName}`, error);\r\n        throw error;\r\n      })\r\n    );\r\n  }\r\n\r\n  // Define methods for each collection\r\n  obtenerDirectiva(): Observable<any[]> {\r\n    return this.callRealmFunction('getDirectivas', []);\r\n  }\r\n\r\n  obtenerGaleria(): Observable<any[]> {\r\n    return this.callRealmFunction('getGalerias', []);\r\n  }\r\n\r\n  obtenerMusicos(): Observable<any[]> {\r\n    return this.callRealmFunction('getIntegrantes', []);\r\n  }\r\n\r\n  obtenerInfo(): Observable<any[]> {\r\n    return this.callRealmFunction('getInfos', []);\r\n  }\r\n\r\n  obtenerEventos(): Observable<any[]> {\r\n    return this.callRealmFunction('getEventos', []);\r\n  }\r\n}"],"mappings":";AACA,SAAqBA,IAAI,EAAEC,SAAS,QAAQ,MAAM;AAClD,SAASC,UAAU,QAAQ,gBAAgB;AAC3C,OAAO,KAAKC,KAAK,MAAM,WAAW;;AAKlC,OAAM,MAAOC,kBAAkB;EAI7BC,YAAA;IACE,MAAMC,MAAM,GAAG,YAAY,CAAC,CAAC;IAC7B,IAAI,CAACC,GAAG,GAAG,IAAIJ,KAAK,CAACK,GAAG,CAAC;MAAEC,EAAE,EAAEH;IAAM,CAAE,CAAC;IAExC;IACA,IAAI,CAACI,KAAK,GAAGV,IAAI,CAAC,IAAI,CAACW,KAAK,EAAE,CAAC;EACjC;EAEcA,KAAKA,CAAA;IAAA,IAAAC,KAAA;IAAA,OAAAC,iBAAA;MACjB,MAAMC,WAAW,GAAGX,KAAK,CAACY,WAAW,CAACC,SAAS,EAAE;MACjD,IAAI;QACF;QACA,aAAaJ,KAAI,CAACL,GAAG,CAACU,KAAK,CAACH,WAAW,CAAC;OACzC,CAAC,OAAOI,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;QACjD,MAAMA,KAAK;;IACZ;EACH;EAEA;EACQE,iBAAiBA,CAACC,YAAoB,EAAEC,IAAA,GAAc,EAAE;IAC9D,OAAO,IAAI,CAACZ,KAAK,CAACa,IAAI,CACpBtB,SAAS,CAACuB,IAAI,IACZxB,IAAI,CAACwB,IAAI,CAACC,SAAS,CAACJ,YAAY,CAAC,CAAC,GAAGC,IAAI,CAAC,CAAC,CAC5C,EACDpB,UAAU,CAACgB,KAAK,IAAG;MACjBC,OAAO,CAACD,KAAK,CAAC,gCAAgCG,YAAY,EAAE,EAAEH,KAAK,CAAC;MACpE,MAAMA,KAAK;IACb,CAAC,CAAC,CACH;EACH;EAEA;EACAQ,gBAAgBA,CAAA;IACd,OAAO,IAAI,CAACN,iBAAiB,CAAC,eAAe,EAAE,EAAE,CAAC;EACpD;EAEAO,cAAcA,CAAA;IACZ,OAAO,IAAI,CAACP,iBAAiB,CAAC,aAAa,EAAE,EAAE,CAAC;EAClD;EAEAQ,cAAcA,CAAA;IACZ,OAAO,IAAI,CAACR,iBAAiB,CAAC,gBAAgB,EAAE,EAAE,CAAC;EACrD;EAEAS,WAAWA,CAAA;IACT,OAAO,IAAI,CAACT,iBAAiB,CAAC,UAAU,EAAE,EAAE,CAAC;EAC/C;EAEAU,cAAcA,CAAA;IACZ,OAAO,IAAI,CAACV,iBAAiB,CAAC,YAAY,EAAE,EAAE,CAAC;EACjD;EAAC,QAAAW,CAAA,G;qBAvDU3B,kBAAkB;EAAA;EAAA,QAAA4B,EAAA,G;WAAlB5B,kBAAkB;IAAA6B,OAAA,EAAlB7B,kBAAkB,CAAA8B,IAAA;IAAAC,UAAA,EAFjB;EAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}